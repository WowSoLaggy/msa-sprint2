# отчёт с описанием внесённых изменений

## booking-subgraph

- Был добавлен захардкоженный набор бронирований для тестирования.
- В схему `gql` был добавлен тип `Hotel` с единственным полем `id: ID`, который будет дополняться из `hotel-subgraph` и возвращаться вместе с `Booking`.
- Был реализован метод `Query.bookingsByUser`, реализуйющий обращение к БД (замоканное заглушкой), плюс ACL проверка, что запрашиваемый `userId` равен `userId` клиента, взятому из http header.

## hotel-subgraph

- Был добавлен захардкоженный набор отелей для тестирования.
- Был добавлен `DataLoader` для батч загрузки отелей по нескольким ID.
- Были реализованы методы `Hotel.__resolveReference` и `Query.hotelsByIds`для получения одного или нескольких отелей из БД (замоканной заглушкой).

## gateway

- Был добавлен новый подграф `promocode-subgraph`.
- Был обновлён инфраструктурный код, обвлён код проброса https headers.

## promocode-subgraph

- Был добавлен новый подграф `promocode-subgraph`, реализующий `ApolloServer` на 4003 порте.
- В схеме `gql` были добавлены элементы `@override` и `@requries` из федерации 2.3. Они позволяют перезаписывать существующее поле `discountPercent`, определённое в сервисе `booking-subgraph`.
- Был добавлен захардкоженный список промокодов для тестирования.
- Был добавлен метод `Booking.discountPercent`, реализующий логику применения обновлённых скидок для заданных промокодов. Если в этом сервисе промокод не указан, то скидка не перезаписывается (остаётся какой пришла из `booking-subgraph`).

## docker-compose.yml

- Новый подграф `promocode-subgraph` был добавлен в `docker-compose.yml` файл.
